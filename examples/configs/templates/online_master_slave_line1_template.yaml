# 在线采集 + 3D 定位配置模板（主从触发：master=Software，slaves=Line1）
#
# 适用：
# - 你已经在硬件上把 master 的 LineOut 接到了 slaves 的 LineIn
# - 你希望只对 master 下发软触发，由 master 输出线触发 slave
#
# 用法示例：
# - uv run python -m tennis3d.apps.online_mvs_localize --config examples/configs/templates/online_master_slave_line1_template.yaml

# MVS Python 示例绑定目录（MvImport，可选）：
mvimport_dir: ""

# MVS SDK 动态库目录（可选）：
dll_dir: ""

# 注意：serials 的顺序对功能通常不敏感，但建议固定顺序，便于对齐输出与排查问题
serials:
  - "<MASTER_SERIAL>"  # master
  - "<SLAVE1_SERIAL>"  # slave1
  - "<SLAVE2_SERIAL>"  # slave2

calib: data/calibration/example_triple_camera_calib.json

# detector 建议先 fake/color 测链路，再切 pt/rknn。
detector: pt
model: data/models/best.pt

min_score: 0.25
require_views: 2

# 多球鲁棒定位参数：
max_detections_per_camera: 10
max_reproj_error_px: 8.0
max_uv_match_dist_px: 25.0
merge_dist_m: 0.08

group_by: frame_num

timeout_ms: 1000
group_timeout_ms: 1000
max_pending_groups: 256
max_groups: 0

out_jsonl: data/tools_output/online_positions_3d.master_slave.line1.template.jsonl

trigger:
  # slave 的触发源：常见为 Line0/Line1（取决于你接线与相机设置）
  trigger_source: Line1

  # master 必须在 serials 列表中
  master_serial: "<MASTER_SERIAL>"

  # 主从触发模式：只对 master 下发软触发
  soft_trigger_fps: 5.0

  # master 输出线设置：把 master 的软触发事件映射到某一路输出线上
  master_line_out: Line1
  master_line_source: ""
  master_line_mode: Output

  trigger_activation: RisingEdge
  trigger_cache_enable: false
