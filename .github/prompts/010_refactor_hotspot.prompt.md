---
name: 010_refactor_hotspot
description: "重构单个热点：诊断->计划->小步实施->自检（保持行为不变）"
argument-hint: "hotspot=路径（文件或目录）"
agent: "agent"
---

重构目标热点路径：${input:hotspot:请输入热点路径，例如 src/foo/bar.py 或 packages/foo/}

如果我在编辑器中选中了代码片段，把它当作重点参考（可能为空）：
${selection}

允许破坏式变更：
- 允许修改模块结构与对外 API
- 禁止保留 wrapper/兼容层/旧模块转发
- 必须同步更新仓库内所有调用点，确保旧路径/旧符号清零

要求你按固定流程输出并执行（不要跳步）：

A) 诊断（只读分析）
- 这个热点承担哪些职责？（列点）
- 主要依赖点/调用方在哪里？（路径 + 关键符号）
- 当前结构问题属于：大文件/高耦合/目录放错/脚本被当库/入口混入库 等哪几类？

B) 计划（可执行迁移方案）
- 拟拆成哪些模块/目录（给出新路径清单）
- 每个模块一句话职责
- 依赖方向：IO/SDK/入口 -> core；core 不得依赖 IO/SDK/入口
- 对外 public API：少量入口函数/类（推荐 import 路径）

C) 小步实施（修改代码/移动文件）
- 一次只做一件事，确保每步改完都可 import/可运行
- 移动/重命名文件后必须同步修复 imports、入口调用方式、配置路径引用（若受影响）
- 不引入新第三方依赖，不上复杂架构/插件系统

D) 自检（必须给出）
- 至少提供一种最小验证方式：冒烟运行路径或最小单测（happy path）
- 若仓库已有测试框架则用现有框架；没有则提供轻量自检函数/脚本示例

输出约束：
- 引用具体路径与符号名；找不到就写“未在仓库中找到”
- 注释/log/docstring 用中文
