---
applyTo: "**"
---

# 仓库文件结构治理与包化规范（移动文件/封装成包）

目标：
- 文件放到“正确目录”，避免 scripts/临时文件与核心库代码混放
- 将可复用的完整功能封装成 Python 包，其他项目可直接 import 调用

目录规划（默认建议，可按仓库实际微调）：
- src/<pkg_name>/...    : 可复用核心库代码（推荐 src-layout；如果仓库已有旧结构则渐进迁移）
- scripts/              : 一次性脚本/离线工具（不作为库 API）
- apps/ 或 cli/         : 程序入口（main、命令行、服务启动）
- tests/                : 单测/集成测试
- configs/              : 配置模板与示例（yaml/json/toml）
- docs/                 : 文档
- tools/                : 开发工具脚本（lint、format、数据转换）
- data/（可选）         : 示例数据（避免放大文件）

何时必须移动文件（任一条满足就移动）：
- “被复用的业务逻辑”放在 scripts/ 或杂乱目录里
- 入口代码（main/cli/server）散落在库目录内部，导致 import 副作用
- 配置/样例数据与核心代码混放且路径引用混乱

移动文件的硬性要求：
- 移动必须同时修复：imports、入口、配置路径引用、文档中的运行方式（若受影响）
- 迁移前后对外 API 保持一致；如果不得不变更，提供兼容层（薄 wrapper）并标注弃用

包化（把“完整功能”封装成可复用包）的验收标准：
A) 有清晰的包边界：`src/<pkg>/` 内只放库代码；入口脚本不放这里
B) 有明确 public API：`src/<pkg>/__init__.py` 或 `api.py` 导出稳定接口
C) 低耦合：包的核心逻辑不依赖项目内的临时脚本/实验代码
D) 可用：提供最小示例（在 docs 或 README）展示 `pip install -e .` 后如何 import 使用
E) 可测：至少 1 个最小单测覆盖 public API 的 happy path

做包化时禁止事项：
- 不要为了“未来可扩展”引入插件系统/抽象工厂/复杂分层
- 不新增第三方依赖（除非已有同类依赖体系）
